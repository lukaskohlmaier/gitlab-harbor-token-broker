# Harbor CI Credential Broker Configuration (Database Mode)

server:
  port: 8080
  read_timeout: 10s
  write_timeout: 10s

gitlab:
  # GitLab instance URL
  instance_url: "https://gitlab.example.com"
  
  # Audience claim expected in JWT (typically the broker's URL)
  audience: "https://broker.example.com"
  
  # JWKS URL for JWT validation (optional, will be auto-constructed if not provided)
  # jwks_url: "https://gitlab.example.com/oauth/discovery/keys"
  
  # Allowed issuers (optional, defaults to instance_url)
  issuers:
    - "https://gitlab.example.com"

harbor:
  # Harbor instance URL
  url: "https://harbor.example.com"
  
  # Admin credentials for creating robot accounts
  # Can be overridden with HARBOR_USERNAME and HARBOR_PASSWORD environment variables
  username: "admin"
  password: "Harbor12345"

security:
  # TTL for robot accounts in minutes (default: 10)
  robot_ttl_minutes: 10

database:
  # Enable database for storing policies and access logs
  # When enabled, policies are managed via the UI instead of this config file
  enabled: true
  
  # PostgreSQL connection string
  # Can be overridden with DATABASE_URL environment variable
  connection_string: "postgresql://broker:broker_password@localhost:5432/harbor_broker?sslmode=disable"

# Policies section is not used when database is enabled
# Policies are managed via the UI
policies: []
